<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Launch Playbook | Remodely AI</title>
  <meta name="description" content="Remodely AI 90-day launch playbook. Track progress from site-live to first paying customers.">
  <meta name="robots" content="noindex, nofollow">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/images/favicon.png">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="/css/styles.css?v=20">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <!-- Starfield Background -->
  <canvas id="starfield" class="starfield-canvas"></canvas>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="container">
      <div class="navbar-inner">
        <a href="/" class="logo">
          <div class="logo-icon">
            <svg viewBox="0 0 24 24" width="44" height="44" fill="none" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <linearGradient id="remodelyHouseGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#4285F4"/>
                  <stop offset="33%" stop-color="#EA4335"/>
                  <stop offset="66%" stop-color="#FBBC05"/>
                  <stop offset="100%" stop-color="#34A853"/>
                </linearGradient>
              </defs>
              <path d="M3 21V10l9-7 9 7v11" stroke="url(#remodelyHouseGrad)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 21h-7" stroke="#34A853" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </div>
          REMODELY<span>.AI</span>
        </a>
        <ul class="nav-links">
          <li><a href="/#services">Services</a></li>
          <li><a href="/#how-it-works">Process</a></li>
          <li><a href="/#about">About</a></li>
          <li><a href="/#contact" class="nav-cta">Get Started</a></li>
        </ul>
        <div class="mobile-toggle">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </nav>

  <!-- Launch Playbook -->
  <section class="legal-page">
    <div class="container">
      <div class="legal-content playbook-page">

        <!-- Header + Progress -->
        <h1>Launch Playbook</h1>
        <p class="legal-updated">Goal: Site-live to 10 paying customers in 30 days</p>

        <div class="playbook-progress-bar">
          <div class="playbook-progress-fill" id="progressFill"></div>
        </div>
        <p class="playbook-progress-text" id="progressText">0 of 0 tasks completed (0%)</p>

        <div class="playbook-controls">
          <button class="playbook-btn" onclick="expandAll()">Expand All</button>
          <button class="playbook-btn" onclick="collapseAll()">Collapse All</button>
          <button class="playbook-btn" onclick="toggleGoals()">Goal Tracker</button>
          <button class="playbook-btn" onclick="toggleSharePanel()">Share / Collaborate</button>
          <button class="playbook-btn" onclick="toggleCalendar()">Calendar</button>
          <button class="playbook-btn" onclick="toggleNotifications()">Notifications</button>
          <button class="playbook-btn playbook-btn-primary" onclick="toggleAuthPanel()">
            <span id="authBtnText">Sign In</span>
          </button>
          <button class="playbook-btn playbook-btn-danger" onclick="resetAll()">Reset Progress</button>
        </div>

        <!-- Sync Status Indicator -->
        <div class="sync-status" id="syncStatus" style="display:none;">
          <span class="sync-icon" id="syncIcon"></span>
          <span class="sync-text" id="syncText">Synced</span>
        </div>

        <!-- GOAL TRACKER PANEL -->
        <div class="playbook-panel" id="goalPanel" style="display:none;">
          <h3>Goal Tracker</h3>
          <p style="color:#64748b;font-size:0.875rem;margin-bottom:1rem;">Set your targets and track actuals. Changes save automatically.</p>
          <div class="goal-grid">
            <div class="goal-card">
              <label class="goal-label">Paying Customers</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="customers-target" placeholder="10"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="customers-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="customers"></div></div>
            </div>
            <div class="goal-card">
              <label class="goal-label">MRR ($)</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="mrr-target" placeholder="3000"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="mrr-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="mrr"></div></div>
            </div>
            <div class="goal-card">
              <label class="goal-label">Demos Given</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="demos-target" placeholder="40"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="demos-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="demos"></div></div>
            </div>
            <div class="goal-card">
              <label class="goal-label">Trials Started</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="trials-target" placeholder="20"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="trials-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="trials"></div></div>
            </div>
            <div class="goal-card">
              <label class="goal-label">Contractors Contacted</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="contacts-target" placeholder="100"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="contacts-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="contacts"></div></div>
            </div>
            <div class="goal-card">
              <label class="goal-label">LinkedIn Followers</label>
              <div class="goal-inputs">
                <div class="goal-field"><span>Target</span><input type="number" data-goal="linkedin-target" placeholder="500"></div>
                <div class="goal-field"><span>Actual</span><input type="number" data-goal="linkedin-actual" placeholder="0"></div>
              </div>
              <div class="goal-bar-wrap"><div class="goal-bar-fill" data-goal-bar="linkedin"></div></div>
            </div>
          </div>
        </div>

        <!-- SHARE / COLLABORATE PANEL -->
        <div class="playbook-panel" id="sharePanel" style="display:none;">
          <h3>Share &amp; Collaborate</h3>
          <p style="color:#64748b;font-size:0.875rem;margin-bottom:1rem;">Share your playbook progress with co-founders, advisors, or team members.</p>
          <div class="share-actions">
            <button class="playbook-btn share-btn" onclick="copyShareLink()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
              Copy Share Link
            </button>
            <button class="playbook-btn share-btn" onclick="exportProgress()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              Export Progress
            </button>
            <button class="playbook-btn share-btn" onclick="document.getElementById('importFile').click()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              Import Progress
            </button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importProgress(event)">
            <button class="playbook-btn share-btn" onclick="emailProgress()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
              Email Summary
            </button>
            <button class="playbook-btn share-btn" onclick="nativeShare()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
              Share...
            </button>
          </div>
          <div id="shareMsg" class="share-message" style="display:none;"></div>
        </div>

        <!-- CALENDAR PANEL -->
        <div class="playbook-panel" id="calendarPanel" style="display:none;">
          <h3>Key Milestones Calendar</h3>
          <p style="color:#64748b;font-size:0.875rem;margin-bottom:1rem;">Add launch milestones to your calendar. Click to add to Google Calendar or download .ics file.</p>
          <div class="calendar-list">
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>Launch Day</strong>
                <span>Announce on LinkedIn, Instagram, X. Email personal network.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('Launch Day - Remodely AI','Announce on LinkedIn, Instagram, X/Twitter. Email personal network. Post on Reddit.',1)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('Launch Day - Remodely AI','Announce on LinkedIn, Instagram, X/Twitter. Email personal network.',1)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>Outreach Sprint (Days 2-3)</strong>
                <span>Visit/call 20 contractors in Phoenix metro. Bring business cards and demo.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('Contractor Outreach Sprint','Visit or call 20 contractors in Phoenix metro. Bring business cards and demo.',2)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('Contractor Outreach Sprint','Visit or call 20 contractors in Phoenix metro.',2)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>Follow-Up Day (Day 5)</strong>
                <span>Text/call all contacts from outreach. Send Loom videos. Post LinkedIn recap.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('Follow-Up Day','Text/call all contacts from outreach sprint. Send personalized Loom videos. Post LinkedIn recap.',5)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('Follow-Up Day','Text/call all contacts from outreach sprint. Send Loom videos.',5)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>First Content Drop (Day 7)</strong>
                <span>Publish YouTube video #1 and first blog post. Share everywhere.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('First Content Drop','Record and publish YouTube video. Write and publish first blog post. Share across all channels.',7)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('First Content Drop','Publish YouTube video and blog post. Share across channels.',7)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>30-Day Review</strong>
                <span>Review metrics: customers, MRR, demos, conversion rates. Decide what to double down on.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('30-Day Launch Review','Review all metrics: paying customers, MRR, demos given, conversion rates. Identify top acquisition channel. Plan next 60 days.',30)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('30-Day Launch Review','Review metrics and plan next 60 days.',30)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>60-Day Check-In</strong>
                <span>Referral program live? Google Ads running? First hire interview?</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('60-Day Check-In','Referral program status. Google Ads performance. Hiring pipeline. Content calendar review.',60)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('60-Day Check-In','Referral program, Google Ads, hiring, content review.',60)">Download .ics</button>
              </div>
            </div>
            <div class="calendar-event">
              <div class="calendar-event-info">
                <strong>90-Day Milestone</strong>
                <span>Hit 25-50 customers? $7.5K+ MRR? Product-market fit assessment.</span>
              </div>
              <div class="calendar-event-actions">
                <button class="playbook-btn" onclick="addToGoogleCal('90-Day Milestone Review','Assess product-market fit. Customer count, MRR, NPS, churn. Plan fundraise or continued bootstrap.',90)">Google Cal</button>
                <button class="playbook-btn" onclick="downloadICS('90-Day Milestone Review','Product-market fit assessment. Plan next phase.',90)">Download .ics</button>
              </div>
            </div>
          </div>
        </div>

        <!-- AUTH PANEL -->
        <div class="playbook-panel" id="authPanel" style="display:none;">
          <h3>Cloud Sync</h3>
          <p style="color:#64748b;font-size:0.875rem;margin-bottom:1rem;">Sign in to sync your progress across devices. Your data is saved locally and synced to the cloud when signed in.</p>

          <div id="authSignedOut">
            <div class="auth-methods">
              <div class="auth-method">
                <label class="auth-label">Email (Magic Link)</label>
                <div class="auth-input-group">
                  <input type="email" id="authEmail" placeholder="you@example.com" class="auth-input">
                  <button class="playbook-btn playbook-btn-primary" onclick="sendMagicLink()">Send Link</button>
                </div>
                <p class="auth-hint">We'll send you a sign-in link. No password needed.</p>
              </div>
              <div class="auth-divider"><span>or</span></div>
              <div class="auth-method">
                <button class="playbook-btn auth-google-btn" onclick="signInWithGoogle()">
                  <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                  Continue with Google
                </button>
              </div>
            </div>
          </div>

          <div id="authSignedIn" style="display:none;">
            <div class="auth-user-info">
              <div class="auth-avatar" id="authAvatar"></div>
              <div class="auth-user-details">
                <strong id="authUserName">User</strong>
                <span id="authUserEmail">user@example.com</span>
              </div>
            </div>
            <div class="auth-actions">
              <button class="playbook-btn" onclick="forceSyncNow()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
                Sync Now
              </button>
              <button class="playbook-btn playbook-btn-danger" onclick="signOut()">Sign Out</button>
            </div>
            <div class="auth-sync-info">
              <p>Last synced: <span id="lastSyncTime">Never</span></p>
            </div>
          </div>

          <div id="authMessage" class="auth-message" style="display:none;"></div>
        </div>

        <!-- NOTIFICATIONS PANEL -->
        <div class="playbook-panel" id="notificationsPanel" style="display:none;">
          <h3>Notifications &amp; Reminders</h3>
          <p style="color:#64748b;font-size:0.875rem;margin-bottom:1rem;">Get reminded about upcoming due dates via browser notifications and daily email digests.</p>

          <div class="notification-section">
            <h4>Browser Notifications</h4>
            <div class="notification-permission" id="notificationPermission">
              <span id="notificationStatus">Checking permission...</span>
              <button class="playbook-btn playbook-btn-primary" id="enableNotificationsBtn" onclick="requestNotificationPermission()" style="display:none;">Enable Notifications</button>
            </div>
            <div class="notification-setting">
              <label class="notification-label">
                <input type="checkbox" id="notifyDueSoon" checked>
                Notify when tasks are due soon
              </label>
            </div>
            <div class="notification-setting">
              <label class="notification-label">Remind me before due date:</label>
              <select id="reminderTime" class="notification-select">
                <option value="3600000">1 hour before</option>
                <option value="86400000" selected>1 day before</option>
                <option value="172800000">2 days before</option>
                <option value="604800000">1 week before</option>
              </select>
            </div>
          </div>

          <div class="notification-section">
            <h4>Daily Email Digest</h4>
            <p class="auth-hint" id="emailDigestAuthHint">Sign in to enable email digests.</p>
            <div id="emailDigestSettings" style="display:none;">
              <div class="notification-setting">
                <label class="notification-label">
                  <input type="checkbox" id="enableEmailDigest">
                  Send daily email digest
                </label>
              </div>
              <div class="notification-setting">
                <label class="notification-label">Send at:</label>
                <select id="digestTime" class="notification-select">
                  <option value="6">6:00 AM</option>
                  <option value="7">7:00 AM</option>
                  <option value="8">8:00 AM</option>
                  <option value="9" selected>9:00 AM</option>
                  <option value="10">10:00 AM</option>
                  <option value="12">12:00 PM</option>
                </select>
              </div>
              <div class="notification-setting">
                <label class="notification-label">Timezone:</label>
                <select id="digestTimezone" class="notification-select">
                  <option value="America/Phoenix" selected>Phoenix (MST)</option>
                  <option value="America/Los_Angeles">Pacific (PST/PDT)</option>
                  <option value="America/Denver">Mountain (MST/MDT)</option>
                  <option value="America/Chicago">Central (CST/CDT)</option>
                  <option value="America/New_York">Eastern (EST/EDT)</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- DUE DATE MODAL -->
        <div class="modal-overlay" id="dueDateModal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Set Due Date</h3>
              <button class="modal-close" onclick="closeDueDateModal()">&times;</button>
            </div>
            <div class="modal-body">
              <p class="modal-task-title" id="modalTaskTitle">Task name here</p>
              <div class="due-date-inputs">
                <div class="due-date-field">
                  <label>Date</label>
                  <input type="date" id="dueDateInput" class="due-date-input">
                </div>
                <div class="due-date-field">
                  <label>Time (optional)</label>
                  <input type="time" id="dueTimeInput" class="due-date-input">
                </div>
              </div>
              <div class="due-date-quick">
                <span>Quick set:</span>
                <button class="playbook-btn" onclick="setQuickDate(0)">Today</button>
                <button class="playbook-btn" onclick="setQuickDate(1)">Tomorrow</button>
                <button class="playbook-btn" onclick="setQuickDate(7)">Next Week</button>
              </div>
            </div>
            <div class="modal-footer">
              <button class="playbook-btn" onclick="clearDueDate()">Clear Date</button>
              <button class="playbook-btn playbook-btn-primary" onclick="saveDueDate()">Save</button>
            </div>
          </div>
        </div>

        <!-- SECTION: Pre-Launch -->
        <div class="playbook-section" data-section="prelaunch">
          <h2 class="playbook-section-header" onclick="toggleSection(this)">
            <span class="playbook-toggle">+</span>
            Pre-Launch Checklist
            <span class="playbook-section-count" data-section-count="prelaunch"></span>
          </h2>
          <div class="playbook-section-body">

            <h3>Business Foundation</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pre-1"> Open business checking account (Chase, Mercury, or Relay) under Remodely AI LLC</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-2"> Confirm IRS EIN is active and linked to bank account</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-3"> File LLC operating agreement (single-member or multi-member)</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-4"> Get business insurance &mdash; general liability + E&amp;O (Hiscox or Next Insurance)</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-5"> Set up QuickBooks Self-Employed or Wave for income/expenses</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-6"> Set up help@remodely.ai (Google Workspace) &mdash; professional email</label>

            <h3>Product Readiness</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pre-7"> Create Stripe account, verify business, set up subscription products ($149, $299, $499)</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-8"> Test full flow: sign up &rarr; configure AI &rarr; book appointment &rarr; generate quote &rarr; invoice &rarr; payment</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-9"> Set up "Demo Contractor" account with sample data for live demos</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-10"> Write step-by-step onboarding guide (target: 15 minutes per customer)</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-11"> Set up support email auto-responder confirming receipt</label>

            <h3>Marketing Assets</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pre-12"> Create 10-slide sales deck (Google Slides): Problem &rarr; Solution &rarr; Screenshots &rarr; Pricing &rarr; CTA</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-13"> Design print-ready one-pager (PDF) for handing out at job sites</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-14"> Record 2-minute demo video: AI Receptionist answering a call + booking appointment</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-15"> Order 500 business cards with QR code to website</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-16"> Create branded email signature</label>

            <h3>Online Presence</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pre-17"> Create Google My Business listing: "Remodely AI" in Phoenix, AZ</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-18"> Create LinkedIn company page with logo, description, website</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-19"> Update personal LinkedIn: "Founder, Remodely AI"</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-20"> Create @remodelyai on Instagram, post 3 initial pieces</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-21"> Create @remodelyai on X/Twitter</label>
            <label class="playbook-item"><input type="checkbox" data-id="pre-22"> Clean up GitHub profile, pin remodely-ai-site repo</label>
          </div>
        </div>

        <!-- SECTION: Launch Week -->
        <div class="playbook-section" data-section="launch">
          <h2 class="playbook-section-header" onclick="toggleSection(this)">
            <span class="playbook-toggle">+</span>
            Launch Week (Days 1&ndash;7)
            <span class="playbook-section-count" data-section-count="launch"></span>
          </h2>
          <div class="playbook-section-body">

            <h3>Day 1: Announce</h3>
            <label class="playbook-item"><input type="checkbox" data-id="launch-1"> Post on LinkedIn: founder story launch announcement</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-2"> Post on Instagram: product screenshot + "We're live"</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-3"> Post on X/Twitter: short announcement with link</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-4"> Email personal network: "I built something &mdash; would love your feedback"</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-5"> Post in Reddit communities (r/smallbusiness, r/contractors, r/entrepreneur)</label>

            <h3>Days 2&ndash;3: Direct Outreach</h3>
            <label class="playbook-item"><input type="checkbox" data-id="launch-6"> Build list of 50 contractors in Phoenix metro (Google Maps, Yelp, Nextdoor)</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-7"> Visit or call 10 contractors (Day 2)</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-8"> Visit or call 10 contractors (Day 3)</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-9"> Offer: free 14-day trial + free setup</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-10"> Collect business cards / phone numbers for follow-up</label>

            <h3>Days 4&ndash;5: Follow Up</h3>
            <label class="playbook-item"><input type="checkbox" data-id="launch-11"> Text/call everyone you met with trial link</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-12"> Send personalized Loom video to each prospect</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-13"> Post LinkedIn recap: "I visited 20 contractors. Here's what I learned..."</label>

            <h3>Days 6&ndash;7: Content</h3>
            <label class="playbook-item"><input type="checkbox" data-id="launch-14"> Record YouTube video #1: "I Built an AI Receptionist for Contractors"</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-15"> Write first blog post: "Why 62% of Contractor Calls Go Unanswered"</label>
            <label class="playbook-item"><input type="checkbox" data-id="launch-16"> Share video/blog across all social channels</label>
          </div>
        </div>

        <!-- SECTION: Weeks 2-4 -->
        <div class="playbook-section" data-section="pipeline">
          <h2 class="playbook-section-header" onclick="toggleSection(this)">
            <span class="playbook-toggle">+</span>
            Weeks 2&ndash;4: Build Pipeline
            <span class="playbook-section-count" data-section-count="pipeline"></span>
          </h2>
          <div class="playbook-section-body">

            <h3>Weekly Outreach (Repeat Each Week)</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-1"> Week 2: Visit/call 10 new contractors</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-2"> Week 2: Follow up with all previous contacts</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-3"> Week 2: Post 2 LinkedIn updates</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-4"> Week 3: Visit/call 10 new contractors</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-5"> Week 3: Follow up with all previous contacts</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-6"> Week 3: Post 2 LinkedIn updates</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-7"> Week 4: Visit/call 10 new contractors</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-8"> Week 4: Follow up with all previous contacts</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-9"> Week 4: Post 2 LinkedIn updates</label>

            <h3>Content (Weeks 2&ndash;4)</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-10"> Record YouTube video #2</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-11"> Write blog post #2</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-12"> Create 3 Instagram posts/reels</label>

            <h3>Partnerships</h3>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-13"> Visit Home Depot Pro desk &mdash; introduce yourself</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-14"> Visit a supplier yard (SRS, ABC Supply, Ferguson)</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-15"> Attend 1 BNI or Chamber of Commerce event</label>
            <label class="playbook-item"><input type="checkbox" data-id="pipe-16"> Contact 1 local trade school about a guest talk</label>
          </div>
        </div>

        <!-- SECTION: Month 2-3 -->
        <div class="playbook-section" data-section="scale">
          <h2 class="playbook-section-header" onclick="toggleSection(this)">
            <span class="playbook-toggle">+</span>
            Months 2&ndash;3: Scale What Works
            <span class="playbook-section-count" data-section-count="scale"></span>
          </h2>
          <div class="playbook-section-body">

            <h3>Analyze &amp; Double Down</h3>
            <label class="playbook-item"><input type="checkbox" data-id="scale-1"> Identify top acquisition channel from first 10 customers</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-2"> Double investment in top channel (more visits, more content, or more ads)</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-3"> Survey first 10 customers: NPS score, feature requests, testimonials</label>

            <h3>Referral Program</h3>
            <label class="playbook-item"><input type="checkbox" data-id="scale-4"> Build referral system: $100 credit for referrer + $100 credit for new customer</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-5"> Give every existing customer their referral link</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-6"> Track referral conversions</label>

            <h3>Google Ads</h3>
            <label class="playbook-item"><input type="checkbox" data-id="scale-7"> Set up Google Ads account</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-8"> Create campaigns: "AI receptionist for contractors," "contractor scheduling software"</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-9"> Budget: $500/month, track cost per lead and cost per conversion</label>

            <h3>Content Calendar</h3>
            <label class="playbook-item"><input type="checkbox" data-id="scale-10"> Publish 4 YouTube videos (1/week)</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-11"> Publish 4 blog posts (1/week)</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-12"> Post 12 LinkedIn updates (3/week)</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-13"> Post 8 Instagram posts/reels (2/week)</label>

            <h3>Hiring</h3>
            <label class="playbook-item"><input type="checkbox" data-id="scale-14"> Post job listings on LinkedIn, Indeed, and Careers page</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-15"> Interview candidates for first contract developer or sales rep</label>
            <label class="playbook-item"><input type="checkbox" data-id="scale-16"> Make first hire</label>
          </div>
        </div>

        <!-- SECTION: 90-Day Goals -->
        <div class="playbook-section" data-section="goals">
          <h2 class="playbook-section-header" onclick="toggleSection(this)">
            <span class="playbook-toggle">+</span>
            90-Day Success Criteria
            <span class="playbook-section-count" data-section-count="goals"></span>
          </h2>
          <div class="playbook-section-body">
            <label class="playbook-item"><input type="checkbox" data-id="goal-1"> 25&ndash;50 paying customers</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-2"> $7,500&ndash;$15,000 monthly recurring revenue</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-3"> NPS score &gt; 50</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-4"> Churn rate &lt; 5%/month</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-5"> Demo-to-trial conversion &gt; 40%</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-6"> Trial-to-paid conversion &gt; 30%</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-7"> First hire made</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-8"> 100+ YouTube subscribers</label>
            <label class="playbook-item"><input type="checkbox" data-id="goal-9"> 500+ LinkedIn followers</label>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2026 Remodely AI LLC. All rights reserved.</p>
        <div class="footer-legal">
          <a href="/privacy.html">Privacy Policy</a>
          <a href="/terms.html">Terms of Service</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="/js/main.js?v=5"></script>
  <script>
    (function() {
      var TASKS_KEY = 'remodely_playbook_progress';
      var GOALS_KEY = 'remodely_playbook_goals';
      var DUE_DATES_KEY = 'remodely_playbook_due_dates';
      var PREFS_KEY = 'remodely_playbook_prefs';

      // --- Firebase Configuration ---
      var FIREBASE_CONFIG = {
        apiKey: "AIzaSyCFePOXREam-AttHStSQwrBuCBkxuTi-F4",
        authDomain: "remodelyai-app.firebaseapp.com",
        projectId: "remodelyai-app",
        storageBucket: "remodelyai-app.firebasestorage.app",
        messagingSenderId: "254256003480",
        appId: "1:254256003480:web:0b5f62324a7fb09a7b13ed"
      };
      var db = null;
      var auth = null;
      var currentUser = null;
      var syncInProgress = false;
      var lastSyncTime = null;
      var unsubscribeSync = null;

      // Initialize Firebase if configured
      if (typeof firebase !== 'undefined' && FIREBASE_CONFIG.apiKey !== "AIzaSyDYOURKEYHERE") {
        firebase.initializeApp(FIREBASE_CONFIG);
        auth = firebase.auth();
        db = firebase.firestore();
        initFirebaseAuth();
      }

      // --- Storage helpers ---
      function load(key) { try { return JSON.parse(localStorage.getItem(key)) || {}; } catch(e) { return {}; } }
      function save(key, data) { localStorage.setItem(key, JSON.stringify(data)); triggerCloudSync(); }

      // --- Progress bar ---
      function updateProgressBar() {
        var all = document.querySelectorAll('.playbook-item input[type="checkbox"]');
        var checked = document.querySelectorAll('.playbook-item input[type="checkbox"]:checked');
        var total = all.length, done = checked.length;
        var pct = total > 0 ? Math.round((done / total) * 100) : 0;
        var fill = document.getElementById('progressFill');
        var text = document.getElementById('progressText');
        if (fill) fill.style.width = pct + '%';
        if (text) text.textContent = done + ' of ' + total + ' tasks completed (' + pct + '%)';
        document.querySelectorAll('.playbook-section').forEach(function(s) {
          var name = s.getAttribute('data-section');
          var sAll = s.querySelectorAll('input[type="checkbox"]');
          var sDone = s.querySelectorAll('input[type="checkbox"]:checked');
          var counter = document.querySelector('[data-section-count="' + name + '"]');
          if (counter) counter.textContent = sDone.length + '/' + sAll.length;
        });
      }

      // --- Init checkboxes ---
      var progress = load(TASKS_KEY);
      document.querySelectorAll('.playbook-item input[type="checkbox"]').forEach(function(cb) {
        var id = cb.getAttribute('data-id');
        if (progress[id]) { cb.checked = true; cb.closest('.playbook-item').classList.add('completed'); }
        cb.addEventListener('change', function() {
          var data = load(TASKS_KEY);
          data[this.getAttribute('data-id')] = this.checked;
          save(TASKS_KEY, data);
          this.closest('.playbook-item').classList.toggle('completed', this.checked);
          updateProgressBar();
        });
      });
      updateProgressBar();

      // --- Load URL state (shared link) ---
      try {
        var params = new URLSearchParams(window.location.search);
        var shared = params.get('state');
        if (shared) {
          var decoded = JSON.parse(atob(shared));
          if (decoded.tasks) {
            save(TASKS_KEY, decoded.tasks);
            document.querySelectorAll('.playbook-item input[type="checkbox"]').forEach(function(cb) {
              var id = cb.getAttribute('data-id');
              cb.checked = !!decoded.tasks[id];
              cb.closest('.playbook-item').classList.toggle('completed', cb.checked);
            });
            updateProgressBar();
          }
          if (decoded.goals) {
            save(GOALS_KEY, decoded.goals);
          }
          window.history.replaceState({}, '', window.location.pathname);
          showShareMsg('Progress imported from shared link.');
        }
      } catch(e) {}

      // --- Section toggle ---
      window.toggleSection = function(header) {
        var body = header.nextElementSibling;
        var toggle = header.querySelector('.playbook-toggle');
        var hidden = body.style.display === 'none';
        body.style.display = hidden ? 'block' : 'none';
        toggle.textContent = hidden ? '\u2212' : '+';
      };
      window.expandAll = function() {
        document.querySelectorAll('.playbook-section-body').forEach(function(b) { b.style.display = 'block'; });
        document.querySelectorAll('.playbook-toggle').forEach(function(t) { t.textContent = '\u2212'; });
      };
      window.collapseAll = function() {
        document.querySelectorAll('.playbook-section-body').forEach(function(b) { b.style.display = 'none'; });
        document.querySelectorAll('.playbook-toggle').forEach(function(t) { t.textContent = '+'; });
      };
      window.resetAll = function() {
        if (!confirm('Reset all task progress and goals? This cannot be undone.')) return;
        localStorage.removeItem(TASKS_KEY);
        localStorage.removeItem(GOALS_KEY);
        document.querySelectorAll('.playbook-item input[type="checkbox"]').forEach(function(cb) {
          cb.checked = false; cb.closest('.playbook-item').classList.remove('completed');
        });
        document.querySelectorAll('[data-goal]').forEach(function(inp) { inp.value = ''; });
        updateProgressBar();
        updateGoalBars();
      };

      // --- Panel toggles ---
      function togglePanel(id) {
        var el = document.getElementById(id);
        var showing = el.style.display !== 'none';
        document.querySelectorAll('.playbook-panel').forEach(function(p) { p.style.display = 'none'; });
        if (!showing) el.style.display = 'block';
      }
      window.toggleGoals = function() { togglePanel('goalPanel'); };
      window.toggleSharePanel = function() { togglePanel('sharePanel'); };
      window.toggleCalendar = function() { togglePanel('calendarPanel'); };

      // --- GOALS ---
      function updateGoalBars() {
        var metrics = ['customers','mrr','demos','trials','contacts','linkedin'];
        metrics.forEach(function(m) {
          var tInput = document.querySelector('[data-goal="'+m+'-target"]');
          var aInput = document.querySelector('[data-goal="'+m+'-actual"]');
          var bar = document.querySelector('[data-goal-bar="'+m+'"]');
          if (!tInput || !aInput || !bar) return;
          var t = parseFloat(tInput.value) || 0;
          var a = parseFloat(aInput.value) || 0;
          var pct = t > 0 ? Math.min(100, Math.round((a / t) * 100)) : 0;
          bar.style.width = pct + '%';
          bar.setAttribute('title', a + ' / ' + t + ' (' + pct + '%)');
          bar.style.background = pct >= 100 ? '#34a853' : pct >= 50 ? '#6366f1' : '#f59e0b';
        });
      }

      // Load saved goals
      var savedGoals = load(GOALS_KEY);
      document.querySelectorAll('[data-goal]').forEach(function(inp) {
        var key = inp.getAttribute('data-goal');
        if (savedGoals[key] !== undefined) inp.value = savedGoals[key];
        inp.addEventListener('input', function() {
          var g = load(GOALS_KEY);
          g[this.getAttribute('data-goal')] = this.value;
          save(GOALS_KEY, g);
          updateGoalBars();
        });
      });
      updateGoalBars();

      // --- SHARING ---
      function getProgressSummary() {
        var all = document.querySelectorAll('.playbook-item input[type="checkbox"]');
        var checked = document.querySelectorAll('.playbook-item input[type="checkbox"]:checked');
        var pct = all.length > 0 ? Math.round((checked.length / all.length) * 100) : 0;
        var goals = load(GOALS_KEY);
        var lines = ['Remodely AI Launch Playbook Progress', ''];
        lines.push('Tasks: ' + checked.length + '/' + all.length + ' completed (' + pct + '%)');
        lines.push('');
        document.querySelectorAll('.playbook-section').forEach(function(s) {
          var header = s.querySelector('.playbook-section-header');
          var sAll = s.querySelectorAll('input[type="checkbox"]');
          var sDone = s.querySelectorAll('input[type="checkbox"]:checked');
          var title = header ? header.textContent.replace(/[+\u2212]/g,'').replace(/\d+\/\d+/,'').trim() : '';
          lines.push('  ' + title + ': ' + sDone.length + '/' + sAll.length);
        });
        if (goals['customers-actual'] || goals['mrr-actual']) {
          lines.push('');
          lines.push('Goals:');
          if (goals['customers-target']) lines.push('  Customers: ' + (goals['customers-actual']||0) + '/' + goals['customers-target']);
          if (goals['mrr-target']) lines.push('  MRR: $' + (goals['mrr-actual']||0) + '/$' + goals['mrr-target']);
          if (goals['demos-target']) lines.push('  Demos: ' + (goals['demos-actual']||0) + '/' + goals['demos-target']);
          if (goals['trials-target']) lines.push('  Trials: ' + (goals['trials-actual']||0) + '/' + goals['trials-target']);
        }
        return lines.join('\n');
      }

      function showShareMsg(msg) {
        var el = document.getElementById('shareMsg');
        if (!el) return;
        el.textContent = msg;
        el.style.display = 'block';
        setTimeout(function() { el.style.display = 'none'; }, 3000);
      }

      window.copyShareLink = function() {
        var state = { tasks: load(TASKS_KEY), goals: load(GOALS_KEY) };
        var encoded = btoa(JSON.stringify(state));
        var url = window.location.origin + window.location.pathname + '?state=' + encoded;
        navigator.clipboard.writeText(url).then(function() {
          showShareMsg('Share link copied to clipboard.');
        }).catch(function() {
          prompt('Copy this link:', url);
        });
      };

      window.exportProgress = function() {
        var state = { tasks: load(TASKS_KEY), goals: load(GOALS_KEY), exported: new Date().toISOString() };
        var blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application/json' });
        var a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'remodely-playbook-progress.json';
        a.click();
        URL.revokeObjectURL(a.href);
        showShareMsg('Progress exported.');
      };

      window.importProgress = function(event) {
        var file = event.target.files[0];
        if (!file) return;
        var reader = new FileReader();
        reader.onload = function(e) {
          try {
            var data = JSON.parse(e.target.result);
            if (data.tasks) {
              save(TASKS_KEY, data.tasks);
              document.querySelectorAll('.playbook-item input[type="checkbox"]').forEach(function(cb) {
                var id = cb.getAttribute('data-id');
                cb.checked = !!data.tasks[id];
                cb.closest('.playbook-item').classList.toggle('completed', cb.checked);
              });
              updateProgressBar();
            }
            if (data.goals) {
              save(GOALS_KEY, data.goals);
              document.querySelectorAll('[data-goal]').forEach(function(inp) {
                var key = inp.getAttribute('data-goal');
                if (data.goals[key] !== undefined) inp.value = data.goals[key];
              });
              updateGoalBars();
            }
            showShareMsg('Progress imported successfully.');
          } catch(err) {
            alert('Invalid file format.');
          }
        };
        reader.readAsText(file);
        event.target.value = '';
      };

      window.emailProgress = function() {
        var summary = getProgressSummary();
        var subject = encodeURIComponent('Remodely AI Launch Playbook - Progress Update');
        var body = encodeURIComponent(summary + '\n\nView playbook: ' + window.location.href);
        window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
      };

      window.nativeShare = function() {
        if (navigator.share) {
          var summary = getProgressSummary();
          navigator.share({ title: 'Remodely AI Launch Playbook', text: summary, url: window.location.href }).catch(function(){});
        } else {
          window.copyShareLink();
        }
      };

      // --- CALENDAR ---
      function futureDate(daysFromNow) {
        var d = new Date();
        d.setDate(d.getDate() + daysFromNow);
        return d;
      }

      function formatGCalDate(date) {
        return date.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}/,'');
      }

      function formatICSDate(date) {
        return date.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}/,'').replace('Z','') + 'Z';
      }

      window.addToGoogleCal = function(title, desc, daysFromNow) {
        var start = futureDate(daysFromNow);
        var end = new Date(start);
        end.setHours(end.getHours() + 2);
        var url = 'https://calendar.google.com/calendar/render?action=TEMPLATE'
          + '&text=' + encodeURIComponent(title)
          + '&dates=' + formatGCalDate(start) + '/' + formatGCalDate(end)
          + '&details=' + encodeURIComponent(desc)
          + '&location=' + encodeURIComponent('Phoenix, AZ');
        window.open(url, '_blank');
      };

      window.downloadICS = function(title, desc, daysFromNow) {
        var start = futureDate(daysFromNow);
        var end = new Date(start);
        end.setHours(end.getHours() + 2);
        var uid = 'remodely-' + daysFromNow + '-' + Date.now() + '@remodely.ai';
        var ics = [
          'BEGIN:VCALENDAR',
          'VERSION:2.0',
          'PRODID:-//Remodely AI//Launch Playbook//EN',
          'BEGIN:VEVENT',
          'UID:' + uid,
          'DTSTART:' + formatICSDate(start),
          'DTEND:' + formatICSDate(end),
          'SUMMARY:' + title,
          'DESCRIPTION:' + desc.replace(/\n/g,'\\n'),
          'LOCATION:Phoenix, AZ',
          'END:VEVENT',
          'END:VCALENDAR'
        ].join('\r\n');
        var blob = new Blob([ics], { type: 'text/calendar' });
        var a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = title.replace(/[^a-zA-Z0-9]/g, '-').toLowerCase() + '.ics';
        a.click();
        URL.revokeObjectURL(a.href);
      };

      // =====================================================
      // SUPABASE AUTHENTICATION
      // =====================================================
      function initFirebaseAuth() {
        if (!auth) return;

        // Listen for auth state changes
        auth.onAuthStateChanged(function(user) {
          if (user) {
            currentUser = user;
            updateAuthUI(true);
            syncFromCloud();
            subscribeToRealtime();
          } else {
            currentUser = null;
            updateAuthUI(false);
            if (unsubscribeSync) {
              unsubscribeSync();
              unsubscribeSync = null;
            }
          }
        });
      }

      function updateAuthUI(signedIn) {
        var authBtnText = document.getElementById('authBtnText');
        var signedOutDiv = document.getElementById('authSignedOut');
        var signedInDiv = document.getElementById('authSignedIn');
        var syncStatus = document.getElementById('syncStatus');
        var emailDigestHint = document.getElementById('emailDigestAuthHint');
        var emailDigestSettings = document.getElementById('emailDigestSettings');

        if (signedIn && currentUser) {
          authBtnText.textContent = 'Account';
          signedOutDiv.style.display = 'none';
          signedInDiv.style.display = 'block';
          syncStatus.style.display = 'flex';
          emailDigestHint.style.display = 'none';
          emailDigestSettings.style.display = 'block';

          // Update user info
          document.getElementById('authUserEmail').textContent = currentUser.email;
          document.getElementById('authUserName').textContent = currentUser.displayName || currentUser.email.split('@')[0];
          var avatar = document.getElementById('authAvatar');
          avatar.textContent = (currentUser.email[0] || 'U').toUpperCase();
        } else {
          authBtnText.textContent = 'Sign In';
          signedOutDiv.style.display = 'block';
          signedInDiv.style.display = 'none';
          syncStatus.style.display = 'none';
          emailDigestHint.style.display = 'block';
          emailDigestSettings.style.display = 'none';
        }
      }

      window.toggleAuthPanel = function() { togglePanel('authPanel'); };
      window.toggleNotifications = function() {
        togglePanel('notificationsPanel');
        checkNotificationPermission();
      };

      window.sendMagicLink = function() {
        if (!auth) {
          showAuthMessage('Cloud sync not configured. Contact support.', 'error');
          return;
        }
        var email = document.getElementById('authEmail').value.trim();
        if (!email) {
          showAuthMessage('Please enter your email address.', 'error');
          return;
        }
        var actionCodeSettings = {
          url: window.location.origin + window.location.pathname,
          handleCodeInApp: true
        };
        auth.sendSignInLinkToEmail(email, actionCodeSettings)
          .then(function() {
            window.localStorage.setItem('emailForSignIn', email);
            showAuthMessage('Check your email for the sign-in link!', 'success');
          })
          .catch(function(error) {
            showAuthMessage(error.message, 'error');
          });
      };

      // Check if returning from email link
      if (auth && auth.isSignInWithEmailLink(window.location.href)) {
        var email = window.localStorage.getItem('emailForSignIn');
        if (email) {
          auth.signInWithEmailLink(email, window.location.href)
            .then(function() {
              window.localStorage.removeItem('emailForSignIn');
              window.history.replaceState({}, '', window.location.pathname);
            })
            .catch(function(error) {
              console.error('Email link sign-in error:', error);
            });
        }
      }

      window.signInWithGoogle = function() {
        if (!auth) {
          showAuthMessage('Cloud sync not configured. Contact support.', 'error');
          return;
        }
        var provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider)
          .catch(function(error) {
            showAuthMessage(error.message, 'error');
          });
      };

      window.signOut = function() {
        if (!auth) return;
        auth.signOut().then(function() {
          showAuthMessage('Signed out successfully.', 'success');
        });
      };

      function showAuthMessage(msg, type) {
        var el = document.getElementById('authMessage');
        if (!el) return;
        el.textContent = msg;
        el.className = 'auth-message auth-message-' + type;
        el.style.display = 'block';
        setTimeout(function() { el.style.display = 'none'; }, 4000);
      }

      // =====================================================
      // CLOUD SYNC
      // =====================================================
      function updateSyncStatus(status, text) {
        var icon = document.getElementById('syncIcon');
        var textEl = document.getElementById('syncText');
        if (!icon || !textEl) return;

        icon.className = 'sync-icon sync-' + status;
        textEl.textContent = text;
      }

      function triggerCloudSync() {
        if (!supabase || !currentUser || syncInProgress) return;

        // Debounce syncs
        clearTimeout(window.syncDebounce);
        window.syncDebounce = setTimeout(syncToCloud, 1000);
      }

      function syncToCloud() {
        if (!db || !currentUser || syncInProgress) return;
        syncInProgress = true;
        updateSyncStatus('syncing', 'Syncing...');

        var tasks = load(TASKS_KEY);
        var goals = load(GOALS_KEY);
        var dueDates = load(DUE_DATES_KEY);
        var prefs = load(PREFS_KEY);

        var userDoc = db.collection('playbook_users').doc(currentUser.uid);

        // Save all data in one document for simplicity
        userDoc.set({
          email: currentUser.email,
          tasks: tasks,
          goals: goals,
          dueDates: dueDates,
          preferences: prefs,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true })
          .then(function() {
            lastSyncTime = new Date();
            updateSyncStatus('synced', 'Synced');
            document.getElementById('lastSyncTime').textContent = lastSyncTime.toLocaleTimeString();
            syncInProgress = false;
          })
          .catch(function(err) {
            console.error('Sync error:', err);
            updateSyncStatus('error', 'Sync failed');
            syncInProgress = false;
          });
      }

      function syncFromCloud() {
        if (!db || !currentUser) return;
        updateSyncStatus('syncing', 'Loading...');

        var userDoc = db.collection('playbook_users').doc(currentUser.uid);

        userDoc.get().then(function(doc) {
          if (doc.exists) {
            var data = doc.data();

            // Load tasks
            if (data.tasks) {
              localStorage.setItem(TASKS_KEY, JSON.stringify(data.tasks));
              document.querySelectorAll('.playbook-item input[type="checkbox"]').forEach(function(cb) {
                var id = cb.getAttribute('data-id');
                cb.checked = !!data.tasks[id];
                cb.closest('.playbook-item').classList.toggle('completed', cb.checked);
              });
              updateProgressBar();
            }

            // Load due dates
            if (data.dueDates) {
              localStorage.setItem(DUE_DATES_KEY, JSON.stringify(data.dueDates));
              updateDueDateIndicators();
            }

            // Load goals
            if (data.goals) {
              localStorage.setItem(GOALS_KEY, JSON.stringify(data.goals));
              document.querySelectorAll('[data-goal]').forEach(function(inp) {
                var key = inp.getAttribute('data-goal');
                if (data.goals[key] !== undefined) inp.value = data.goals[key];
              });
              updateGoalBars();
            }

            // Load preferences
            if (data.preferences) {
              localStorage.setItem(PREFS_KEY, JSON.stringify(data.preferences));
              loadNotificationPreferences();
            }
          }

          lastSyncTime = new Date();
          updateSyncStatus('synced', 'Synced');
          document.getElementById('lastSyncTime').textContent = lastSyncTime.toLocaleTimeString();
        }).catch(function(err) {
          console.error('Load error:', err);
          updateSyncStatus('error', 'Load failed');
        });
      }

      window.forceSyncNow = function() {
        syncToCloud();
      };

      function subscribeToRealtime() {
        if (!db || !currentUser) return;

        // Unsubscribe from previous listener if exists
        if (unsubscribeSync) {
          unsubscribeSync();
        }

        var userDoc = db.collection('playbook_users').doc(currentUser.uid);

        unsubscribeSync = userDoc.onSnapshot(function(doc) {
          if (doc.exists && !syncInProgress) {
            var data = doc.data();

            // Update tasks from another device
            if (data.tasks) {
              var currentTasks = load(TASKS_KEY);
              var changed = false;

              Object.keys(data.tasks).forEach(function(taskId) {
                if (currentTasks[taskId] !== data.tasks[taskId]) {
                  changed = true;
                  var cb = document.querySelector('[data-id="' + taskId + '"]');
                  if (cb) {
                    cb.checked = data.tasks[taskId];
                    cb.closest('.playbook-item').classList.toggle('completed', data.tasks[taskId]);
                  }
                }
              });

              if (changed) {
                localStorage.setItem(TASKS_KEY, JSON.stringify(data.tasks));
                updateProgressBar();
              }
            }
          }
        }, function(error) {
          console.error('Real-time sync error:', error);
        });
      }

      // =====================================================
      // DUE DATES
      // =====================================================
      var currentDueDateTask = null;

      function addDueDateButtons() {
        document.querySelectorAll('.playbook-item').forEach(function(item) {
          if (item.querySelector('.due-date-btn')) return; // Already has button

          var btn = document.createElement('button');
          btn.className = 'due-date-btn';
          btn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>';
          btn.onclick = function(e) {
            e.stopPropagation();
            var taskId = item.querySelector('input[type="checkbox"]').getAttribute('data-id');
            openDueDateModal(taskId, item.textContent.trim());
          };
          item.appendChild(btn);

          // Add due date indicator span
          var indicator = document.createElement('span');
          indicator.className = 'due-date-indicator';
          indicator.setAttribute('data-due-indicator', item.querySelector('input').getAttribute('data-id'));
          item.appendChild(indicator);
        });
      }

      function openDueDateModal(taskId, taskTitle) {
        currentDueDateTask = taskId;
        document.getElementById('modalTaskTitle').textContent = taskTitle.replace(/[\n\r]+/g, ' ').substring(0, 100);

        var dueDates = load(DUE_DATES_KEY);
        var existing = dueDates[taskId];
        if (existing) {
          document.getElementById('dueDateInput').value = existing.date || '';
          document.getElementById('dueTimeInput').value = existing.time || '';
        } else {
          document.getElementById('dueDateInput').value = '';
          document.getElementById('dueTimeInput').value = '';
        }

        document.getElementById('dueDateModal').style.display = 'flex';
      }

      window.closeDueDateModal = function() {
        document.getElementById('dueDateModal').style.display = 'none';
        currentDueDateTask = null;
      };

      window.setQuickDate = function(daysFromNow) {
        var date = new Date();
        date.setDate(date.getDate() + daysFromNow);
        document.getElementById('dueDateInput').value = date.toISOString().split('T')[0];
      };

      window.saveDueDate = function() {
        if (!currentDueDateTask) return;

        var date = document.getElementById('dueDateInput').value;
        var time = document.getElementById('dueTimeInput').value;

        var dueDates = load(DUE_DATES_KEY);
        if (date) {
          dueDates[currentDueDateTask] = { date: date, time: time || null };
        } else {
          delete dueDates[currentDueDateTask];
        }
        save(DUE_DATES_KEY, dueDates);

        updateDueDateIndicators();
        scheduleNotificationsForDueDates();
        closeDueDateModal();
      };

      window.clearDueDate = function() {
        if (!currentDueDateTask) return;

        var dueDates = load(DUE_DATES_KEY);
        delete dueDates[currentDueDateTask];
        save(DUE_DATES_KEY, dueDates);

        updateDueDateIndicators();
        closeDueDateModal();
      };

      function updateDueDateIndicators() {
        var dueDates = load(DUE_DATES_KEY);
        var now = new Date();
        var tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);

        document.querySelectorAll('[data-due-indicator]').forEach(function(indicator) {
          var taskId = indicator.getAttribute('data-due-indicator');
          var dueData = dueDates[taskId];

          if (!dueData || !dueData.date) {
            indicator.textContent = '';
            indicator.className = 'due-date-indicator';
            return;
          }

          var dueDate = new Date(dueData.date + (dueData.time ? 'T' + dueData.time : 'T23:59:59'));
          var item = indicator.closest('.playbook-item');
          var isCompleted = item.classList.contains('completed');

          if (isCompleted) {
            indicator.textContent = formatDueDate(dueData.date);
            indicator.className = 'due-date-indicator due-completed';
          } else if (dueDate < now) {
            indicator.textContent = 'Overdue: ' + formatDueDate(dueData.date);
            indicator.className = 'due-date-indicator due-overdue';
          } else if (dueDate < tomorrow) {
            indicator.textContent = 'Due today';
            indicator.className = 'due-date-indicator due-soon';
          } else if (dueDate < new Date(now.getTime() + 3 * 24 * 60 * 60 * 1000)) {
            indicator.textContent = 'Due: ' + formatDueDate(dueData.date);
            indicator.className = 'due-date-indicator due-soon';
          } else {
            indicator.textContent = 'Due: ' + formatDueDate(dueData.date);
            indicator.className = 'due-date-indicator';
          }
        });
      }

      function formatDueDate(dateStr) {
        var date = new Date(dateStr + 'T12:00:00');
        var options = { month: 'short', day: 'numeric' };
        return date.toLocaleDateString('en-US', options);
      }

      // Close modal on escape or outside click
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeDueDateModal();
      });
      document.getElementById('dueDateModal')?.addEventListener('click', function(e) {
        if (e.target === this) closeDueDateModal();
      });

      // =====================================================
      // BROWSER NOTIFICATIONS
      // =====================================================
      function checkNotificationPermission() {
        var statusEl = document.getElementById('notificationStatus');
        var enableBtn = document.getElementById('enableNotificationsBtn');

        if (!('Notification' in window)) {
          statusEl.textContent = 'Notifications not supported in this browser.';
          enableBtn.style.display = 'none';
          return;
        }

        if (Notification.permission === 'granted') {
          statusEl.textContent = 'Notifications are enabled.';
          statusEl.className = 'notification-enabled';
          enableBtn.style.display = 'none';
        } else if (Notification.permission === 'denied') {
          statusEl.textContent = 'Notifications are blocked. Enable in browser settings.';
          statusEl.className = 'notification-denied';
          enableBtn.style.display = 'none';
        } else {
          statusEl.textContent = 'Notifications are not enabled.';
          enableBtn.style.display = 'inline-block';
        }
      }

      window.requestNotificationPermission = function() {
        Notification.requestPermission().then(function(permission) {
          checkNotificationPermission();
          if (permission === 'granted') {
            registerServiceWorker();
            scheduleNotificationsForDueDates();
          }
        });
      };

      function registerServiceWorker() {
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/sw-notifications.js')
            .then(function(registration) {
              console.log('Service Worker registered:', registration);
            })
            .catch(function(err) {
              console.error('Service Worker registration failed:', err);
            });
        }
      }

      function scheduleNotificationsForDueDates() {
        if (Notification.permission !== 'granted') return;

        var dueDates = load(DUE_DATES_KEY);
        var tasks = load(TASKS_KEY);
        var prefs = load(PREFS_KEY);
        var reminderMs = parseInt(prefs.reminderTime || '86400000'); // Default 1 day

        Object.keys(dueDates).forEach(function(taskId) {
          if (tasks[taskId]) return; // Task already completed

          var dueData = dueDates[taskId];
          if (!dueData.date) return;

          var dueDate = new Date(dueData.date + (dueData.time ? 'T' + dueData.time : 'T09:00:00'));
          var notifyAt = new Date(dueDate.getTime() - reminderMs);
          var now = new Date();

          if (notifyAt > now) {
            var delay = notifyAt.getTime() - now.getTime();
            setTimeout(function() {
              showNotification(taskId, dueData.date);
            }, delay);
          }
        });
      }

      function showNotification(taskId, dueDate) {
        var tasks = load(TASKS_KEY);
        if (tasks[taskId]) return; // Already completed

        var item = document.querySelector('[data-id="' + taskId + '"]');
        var taskText = item ? item.closest('.playbook-item').textContent.trim().substring(0, 60) : 'Task';

        if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
          navigator.serviceWorker.controller.postMessage({
            type: 'SHOW_NOTIFICATION',
            title: 'Task Due Soon',
            body: taskText,
            tag: 'task-' + taskId
          });
        } else {
          new Notification('Task Due Soon', {
            body: taskText,
            icon: '/images/favicon.png',
            tag: 'task-' + taskId
          });
        }
      }

      // =====================================================
      // NOTIFICATION PREFERENCES
      // =====================================================
      function loadNotificationPreferences() {
        var prefs = load(PREFS_KEY);

        var notifyDueSoon = document.getElementById('notifyDueSoon');
        var reminderTime = document.getElementById('reminderTime');
        var enableEmailDigest = document.getElementById('enableEmailDigest');
        var digestTime = document.getElementById('digestTime');
        var digestTimezone = document.getElementById('digestTimezone');

        if (notifyDueSoon) notifyDueSoon.checked = prefs.notifyDueSoon !== false;
        if (reminderTime) reminderTime.value = prefs.reminderTime || '86400000';
        if (enableEmailDigest) enableEmailDigest.checked = prefs.enableEmailDigest || false;
        if (digestTime) digestTime.value = prefs.digestTime || '9';
        if (digestTimezone) digestTimezone.value = prefs.digestTimezone || 'America/Phoenix';
      }

      function saveNotificationPreferences() {
        var prefs = {
          notifyDueSoon: document.getElementById('notifyDueSoon')?.checked,
          reminderTime: document.getElementById('reminderTime')?.value,
          enableEmailDigest: document.getElementById('enableEmailDigest')?.checked,
          digestTime: document.getElementById('digestTime')?.value,
          digestTimezone: document.getElementById('digestTimezone')?.value
        };
        save(PREFS_KEY, prefs);
      }

      // Attach change listeners to preference inputs
      ['notifyDueSoon', 'reminderTime', 'enableEmailDigest', 'digestTime', 'digestTimezone'].forEach(function(id) {
        var el = document.getElementById(id);
        if (el) {
          el.addEventListener('change', saveNotificationPreferences);
        }
      });

      // =====================================================
      // INITIALIZATION
      // =====================================================
      // Add due date buttons after DOM is ready
      addDueDateButtons();
      updateDueDateIndicators();
      loadNotificationPreferences();
      checkNotificationPermission();

      // Register service worker if notifications are enabled
      if (Notification.permission === 'granted') {
        registerServiceWorker();
        scheduleNotificationsForDueDates();
      }

    })();
  </script>
</body>
</html>
